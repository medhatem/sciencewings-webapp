<div class="sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent">
  <!-- Header -->
  <div class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-8 px-6 md:px-8 border-b">
    <!-- Loader -->
    <div class="absolute inset-x-0 bottom-0" *ngIf="isLoading">
      <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
    </div>
    <!-- Title -->
    <div class="text-4xl font-extrabold tracking-tight">Inventory</div>
    <!-- Actions -->
    <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
      <!-- Search -->
      <mat-form-field class="fuse-mat-dense fuse-mat-no-subscript fuse-mat-rounded min-w-64">
        <mat-icon class="icon-size-5" matPrefix [svgIcon]="'heroicons_solid:search'"></mat-icon>
        <input matInput [formControl]="searchInputControl" [autocomplete]="'off'" [placeholder]="'Search resources$'" />
      </mat-form-field>
      <!-- Add resource button -->
      <button class="ml-4" mat-flat-button [color]="'primary'" (click)="createResource()">
        <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
        <span class="ml-2 mr-1">Add</span>
      </button>
    </div>
  </div>

  <!-- Main -->
  <div class="flex flex-auto overflow-hidden">
    <!-- Products list -->
    <div class="flex flex-col flex-auto sm:mb-18 overflow-hidden sm:overflow-y-auto">
      <!-- <ng-container *ngIf="resources$">
        <ng-container *ngIf="resources$.length > 0; else noProducts"> -->

      <!-- <div *ngIf="resources$ | async as resources"> -->
      <!-- <p *ngIf="resources.length">LENGTH:: {{ resources.length }}</p> -->
      <!-- <p>LENGTH:: {{ resources.length }}</p> -->
      <!-- <p>LENGTH:: {{ resources[0].name }}</p> -->
      <!-- <div *ngFor="let resource of resources  | keyvalue">
        <p>{{ resource.name }}</p>
      </div> -->
      <!-- </div> -->

      <div class="grid">
        <!-- Header -->
        <div
          class="inventory-grid z-10 sticky top-0 grid gap-4 py-4 px-6 md:px-8 shadow text-md font-semibold text-secondary bg-gray-50 dark:bg-black dark:bg-opacity-5"
          matSort
          matSortDisableClear
        >
          <div class="hidden lg:block">Name</div>
          <div class="hidden lg:block">Resource Type</div>
          <div class="hidden lg:block">Timezone</div>
          <div class="hidden lg:block">Active</div>
          <div class="hidden lg:block">Details</div>
        </div>

        <!-- Rows -->
        <!-- <ng-container *ngIf="resources$"> -->
        <ng-container *ngFor="let resource of resources">
          <div class="inventory-grid grid items-center gap-4 py-3 px-6 md:px-8 border-b">
            <!-- Name -->
            <div class="hidden lg:block">
              {{ resource.name }}
            </div>
            <!-- resourceType -->
            <div class="hidden lg:block">
              {{ resource.resourceType }}
            </div>
            <!-- Timezone -->
            <div class="hidden lg:block">
              {{ resource.timezone }}
            </div>

            <!-- Active -->
            <div class="lg:block">
              <ng-container *ngIf="resource.active">
                <mat-icon class="text-green-400 icon-size-5" [svgIcon]="'heroicons_solid:check'"></mat-icon>
              </ng-container>
              <ng-container *ngIf="!resource.active">
                <mat-icon class="text-gray-400 icon-size-5" [svgIcon]="'heroicons_solid:x'"></mat-icon>
              </ng-container>
            </div>

            <!-- Details button -->
            <div>
              <button class="min-w-10 min-h-7 h-7 px-2 leading-6" mat-stroked-button (click)="toggleDetails(resource.id)">
                <mat-icon
                  class="icon-size-5"
                  [svgIcon]="selectedResource?.id === resource.id ? 'heroicons_solid:chevron-up' : 'heroicons_solid:chevron-down'"
                ></mat-icon>
              </button>
            </div>
          </div>
          <div class="grid">
            <ng-container *ngIf="selectedResource?.id === resource.id">
              <ng-container *ngTemplateOutlet="rowDetailsTemplate; context: { $implicit: resource }"></ng-container>
            </ng-container>
          </div>
        </ng-container>
        <!-- </ng-container> -->
      </div>
      <!-- </ng-container
      ></ng-container> -->

      <ng-template #rowDetailsTemplate let-resource>
        <div class="shadow-lg overflow-hidden">
          <div class="flex border-b">
            <mat-card class="resource-card-detail">
              <mat-card-title>{{ resource.name }}</mat-card-title>
              <mat-card-subtitle><strong>Created at:</strong> {{ resource.createdAt.replace('T', ' ').replace('Z', '') }}</mat-card-subtitle>
              <mat-card-subtitle *ngIf="resource.user"
                ><strong>Created by:</strong> {{ resource.user.firstname + ' ' + resource.user.lastname }}</mat-card-subtitle
              >
              <mat-card-subtitle *ngIf="resource.organization"> <strong>Owned by:</strong> {{ resource.organization.name }} </mat-card-subtitle>
              <mat-card-actions style="display: flex; justify-content: end">
                <button mat-button color="warn" (click)="onDelete(resource.id)">Remove</button>
                <button mat-button color="primary" routerLinkActive="active" [routerLink]="['/admin/resources/', resource.id]" >Update</button>
              </mat-card-actions>
            </mat-card>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>
<router-outlet></router-outlet>
